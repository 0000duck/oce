From 72c4a1b5cb2d902d9b3a31a6fe550e9dd8f7aeb5 Mon Sep 17 00:00:00 2001
From: Jerome Robert <jeromerobert@users.sf.net>
Date: Mon, 24 Oct 2011 15:09:07 +0200
Subject: [PATCH] Disable the BSpline mesher

---
 src/BRepMesh/BRepMesh_FastDiscretFace.cxx |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

From b1f8dc99b7dc4de8015593bf49907226eaa0ad74 Mon Sep 17 00:00:00 2001
From: QbProg <tholag@gmail.com>
Date: Sun, 20 Nov 2011 15:30:14 +0100
Subject: [PATCH] Adds an option to disable the bspline mesher, and reverts to
 OFF (not disabled) the default behavoir

---
 CMakeLists.txt                            |    2 ++
 oce_build_config.h.cmake                  |    3 +++
 src/BRepMesh/BRepMesh_FastDiscretFace.cxx |    3 +--
 3 files changed, 6 insertions(+), 2 deletions(-)

Index: oce/CMakeLists.txt
===================================================================
--- oce.orig/CMakeLists.txt
+++ oce/CMakeLists.txt
@@ -107,6 +107,8 @@ OPTION_WITH_DEFAULT( ${PROJECT_NAME}_TES
 MARK_AS_ADVANCED(${PROJECT_NAME}_TESTING)
 OPTION_WITH_DEFAULT( ${PROJECT_NAME}_ADD_HEADERS "Add headers to project files" OFF )
 MARK_AS_ADVANCED(${PROJECT_NAME}_ADD_HEADERS)
+OPTION_WITH_DEFAULT( ${PROJECT_NAME}_DISABLE_BSPLINE_MESHER "Disable BSpline Mesher" OFF )
+MARK_AS_ADVANCED(${PROJECT_NAME}_DISABLE_BSPLINE_MESHER)
 
 IF(NOT MSVC)
 	OPTION_WITH_DEFAULT( ${PROJECT_NAME}_COVERAGE "Build with coverage testing" OFF )
Index: oce/oce_build_config.h.cmake
===================================================================
--- oce.orig/oce_build_config.h.cmake
+++ oce/oce_build_config.h.cmake
@@ -272,3 +272,6 @@
 
 /* Whether OCE is build as static lib */
 #cmakedefine OCE_BUILD_STATIC_LIB
+
+/* Whether disable or not the bspline mesher */
+#cmakedefine OCE_DISABLE_BSPLINE_MESHER
Index: oce/src/BRepMesh/BRepMesh_FastDiscretFace.cxx
===================================================================
--- oce.orig/src/BRepMesh/BRepMesh_FastDiscretFace.cxx
+++ oce/src/BRepMesh/BRepMesh_FastDiscretFace.cxx
@@ -898,6 +898,7 @@ void BRepMesh_FastDiscretFace::InternalV
       }
     }
   }
+#if !defined(OCE_DISABLE_BSPLINE_MESHER)
   else if (thetype == GeomAbs_BezierSurface || thetype == GeomAbs_BSplineSurface)
   {
     //define resolutions
@@ -1044,6 +1045,7 @@ void BRepMesh_FastDiscretFace::InternalV
       }
     }
   }
+  #endif
   else {
     const Standard_Real anAngle = 0.35;
 
